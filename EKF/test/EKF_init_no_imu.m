function ekf = EKF_init_no_imu(n_sat)
    n = 8;
    dim = 3;
    c = 299792458;
    h = 2^-1;
    
    ekf.cfg.dim = dim;
    ekf.cfg.n = n; %pos, vel, ang, bias
    ekf.cfg.h = h;
    ekf.cfg.c = c;

    ekf.h = @geometry_matrix_no_imu;                       %Measure function
    ekf.A = [zeros(dim)     eye(dim)        zeros(dim, 1)   zeros(dim, 1);
             zeros(dim)     zeros(dim)      zeros(dim, 1)   zeros(dim, 1);
             zeros(1, dim)  zeros(1, dim)   0               1;
             zeros(1, dim)  zeros(1, dim)   0               0];

    ekf.B = [zeros(dim)     zeros(dim, 1)   zeros(dim, 1);
             eye(dim)       zeros(dim, 1)   zeros(dim, 1);
             zeros(1, dim)  c               0;
             zeros(1, dim)  0               c];
    
    sys = ss(ekf.A, ekf.B, zeros(n_sat, n), zeros(n_sat, size(ekf.B, 2)));
    sys = c2d(sys, h);     
    ekf.A = sys.A;
    ekf.B = sys.B;
    
    ekf.Q = diag([zeros(1, 3) 0.1*ones(1, 3) 10 10]);
    %ekf.Q(1:3, 1:3) = zeros(3);
    ekf.Q = ekf.Q;
    
    ekf.R  = eye(n_sat);
    ekf.P  = eye(8);
    ekf.P_ = [54.9917605561929,6.80003179815706,24.7404607326298,78.9400935415345,5.81796401025435,20.5449638684284,15.3418426044192,3.94526869599251;6.80003179815706,37.6276774838850,11.0298200939347,5.81770799929330,63.4573516869178,9.33394557874424,5.91251804202489,1.51690768361990;24.7404607326298,11.0298200939347,83.0333083924630,20.5436305523481,9.33382771007356,102.275014796193,23.1636582373224,5.92783407807167;78.9400935415345,5.81770799929330,20.5436305523481,233.284589053395,6.06483146434953,20.8643753796983,11.6453034848336,3.27710118255809;5.81796401025435,63.4573516869178,9.33382771007356,6.06483146434953,216.588359678349,9.63827276262687,4.43083202588311,1.24554493409078;20.5449638684284,9.33394557874424,102.275014796193,20.8643753796983,9.63827276262687,257.023190401678,17.1117203302543,4.80459227746538;15.3418426044192,5.91251804202489,23.1636582373224,11.6453034848336,4.43083202588311,17.1117203302543,1184.58608669749,345.526322071307;3.94526869599251,1.51690768361990,5.92783407807167,3.27710118255809,1.24554493409078,4.80459227746538,345.526322071307,785.306156168743];%eye(8);
    
    P0 = [2.799832e+06; 4.79942e+05; 5.691477e+06];
    %P0 = [4060565.23310000;608399.449100000;4864639.90330000];
    P0 = [0; 0; 0];
    
    ekf.x_hat_  = [P0; zeros(3, 1); 0; 0];
    ekf.x_hat   = [P0; zeros(3, 1); 0; 0];
    ekf.res = 0;
end