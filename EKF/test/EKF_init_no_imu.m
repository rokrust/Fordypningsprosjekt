function ekf = EKF_init_no_imu(n_sat)
    n = 8;
    dim = 3;
    c = 299792458;
    h = 2^-1;
    
    ekf.cfg.dim = dim;
    ekf.cfg.n = n; %pos, vel, ang, bias
    ekf.cfg.h = h;
    ekf.cfg.c = c;

    ekf.h = @geometry_matrix_no_imu;                       %Measure function
    ekf.A = [zeros(dim)     eye(dim)        zeros(dim, 1)   zeros(dim, 1);
             zeros(dim)     zeros(dim)      zeros(dim, 1)   zeros(dim, 1);
             zeros(1, dim)  zeros(1, dim)   0               1;
             zeros(1, dim)  zeros(1, dim)   0               0];

    ekf.B = [zeros(dim)     zeros(dim, 1)   zeros(dim, 1);
             eye(dim)       zeros(dim, 1)   zeros(dim, 1);
             zeros(1, dim)  c               0;
             zeros(1, dim)  0               c];
    
    sys = ss(ekf.A, ekf.B, zeros(n_sat, n), zeros(n_sat, size(ekf.B, 2)));
    sys = c2d(sys, h);     
    ekf.A = sys.A;
    ekf.B = sys.B;
    
    ekf.Q = diag([zeros(1, 3) zeros(1, 3) 0.1 5]);
    %{
    ekf.Q = [   zeros(dim)        zeros(dim)      zeros(dim, 1)   zeros(dim, 1)
                zeros(dim)      eye(dim)        zeros(dim, 1)   zeros(dim, 1);   
                zeros(1, dim)   zeros(1, dim)   4*10^-19        0;
                zeros(1, dim)   zeros(1, dim)   0               32*(pi^2)*(10^(-20))];   
    %}
    ekf.R = 10*eye(n_sat);
    ekf.P       = eye(8);%[0.00246462520839287,0.000856878751189075,0.00279068998534755,6.90093117377795e-07,2.28302475726303e-07,7.59821182784829e-07,0.00210243971487074,5.91463583634173e-07;0.000856878751189075,0.00132901922783200,0.00153489623247810,2.27390348726913e-07,3.68625449957310e-07,4.06560141906295e-07,0.00114336077391727,3.20349782364079e-07;0.00279068998534755,0.00153489623247810,0.00627783945696184,7.59559811197028e-07,4.08192774869287e-07,1.72058894954455e-06,0.00359776926974595,1.01100979335349e-06;6.90093117377795e-07,2.27390348726913e-07,7.59559811197028e-07,2.55099918499461e-10,7.52363295497421e-11,2.67483577195956e-10,5.78385416830620e-07,2.10704851973262e-10;2.28302475726303e-07,3.68625449957310e-07,4.08192774869287e-07,7.52363295497421e-11,1.31917915488781e-10,1.34222509286105e-10,3.07366716391353e-07,1.07151323587523e-10;7.59821182784829e-07,4.06560141906295e-07,1.72058894954455e-06,2.67483577195956e-10,1.34222509286105e-10,6.12038792032074e-10,9.81215602456889e-07,3.53819441664178e-10;0.00210243971487073,0.00114336077391727,0.00359776926974595,5.78385416830620e-07,3.07366716391353e-07,9.81215602456889e-07,0.821029421359763,0.406455373972956;5.91463583634173e-07,3.20349782364079e-07,1.01100979335349e-06,2.10704851973262e-10,1.07151323587523e-10,3.53819441664178e-10,0.406455373972956,0.502859680600372];
    ekf.P_      = [0.00246462520839287,0.000856878751189075,0.00279068998534755,6.90093117377795e-07,2.28302475726303e-07,7.59821182784829e-07,0.00210243971487074,5.91463583634173e-07;0.000856878751189075,0.00132901922783200,0.00153489623247810,2.27390348726913e-07,3.68625449957310e-07,4.06560141906295e-07,0.00114336077391727,3.20349782364079e-07;0.00279068998534755,0.00153489623247810,0.00627783945696184,7.59559811197028e-07,4.08192774869287e-07,1.72058894954455e-06,0.00359776926974595,1.01100979335349e-06;6.90093117377795e-07,2.27390348726913e-07,7.59559811197028e-07,2.55099918499461e-10,7.52363295497421e-11,2.67483577195956e-10,5.78385416830620e-07,2.10704851973262e-10;2.28302475726303e-07,3.68625449957310e-07,4.08192774869287e-07,7.52363295497421e-11,1.31917915488781e-10,1.34222509286105e-10,3.07366716391353e-07,1.07151323587523e-10;7.59821182784829e-07,4.06560141906295e-07,1.72058894954455e-06,2.67483577195956e-10,1.34222509286105e-10,6.12038792032074e-10,9.81215602456889e-07,3.53819441664178e-10;0.00210243971487073,0.00114336077391727,0.00359776926974595,5.78385416830620e-07,3.07366716391353e-07,9.81215602456889e-07,0.821029421359763,0.406455373972956;5.91463583634173e-07,3.20349782364079e-07,1.01100979335349e-06,2.10704851973262e-10,1.07151323587523e-10,3.53819441664178e-10,0.406455373972956,0.502859680600372];
    %ekf.P_ = eye(8);
    P0 = [2.799832e+06; 4.79942e+05; 5.691477e+06];
    ekf.x_hat_  = [P0; zeros(3, 1); 0; 0];
    ekf.x_hat   = [P0; zeros(3, 1); 0; 0];
end